{% extends "layout.html" %}

{% block content %}
<h2 class="text-center text-uppercase text-secondary mb-0">{{ publisher.name }}</h2>
<hr class="star-dark mb-5">

<div class="row">
  <div class="col-lg-12">

{% if publisher.last_checked_at %}
    <p>{{ errors | count }} of {{ publisher.total_datasets }} datasets have errors.</p>
{% else %}
    <p>{{ publisher.total_datasets }} datasets have not yet been checked.</p>
{% endif %}

<table class="table">
    <thead>
        <tr>
            <th>Error type</th>
            <th>Dataset name</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
{% for error in errors %}
        <tr>
            <td>
                {{ error.error_type }}
            </td>
            <td>
                <a href="https://iatiregistry.org/dataset/{{ error.dataset_id }}">{{ error.dataset_name }}</a> (<a href="{{ error.dataset_url }}" target="_blank">source</a>)
            </td>
            <td>
                Last errored {{ error.last_errored_at }}
            </td>
        </tr>
{% endfor %}
    </tbody>
</table>

{% if publisher.last_checked_at %}
    <p>Last checked: {{ publisher.last_checked_at }}</p>
{% endif %}
    </div>
</div>
{% endblock %}
